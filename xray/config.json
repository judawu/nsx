{
  "log": {
    "loglevel": "debug",
    "error": "/usr/local/nsx/log/xray_error.log",
    "access": "/usr/local/nsx/log/xray_access.log"
  },
  "api": {
    "tag": "api",
    "services": [
      "HandlerService",
      "LoggerService",
      "StatsService"
    ]
  },
 "dns": {
    "tag": "dns_inbound",
    "hosts": {
      "geosite:category-ads-all": "127.0.0.1", 
      "dns.google": ["8.8.8.8", "8.8.4.4"]
    },
    "servers": [ 
      "quic+local://dns.adguard.com",
      "tcp+local://94.140.14.49:53",
      "94.140.14.59",  
      "45.90.28.0",
      "45.90.30.0",
      "146.112.61.108",
      "185.220.100.240",
      "185.220.101.240",
      "8.8.8.8",
      "8.8.4.4",
      "1.1.1.1",
      {
      "address": "8.8.8.8",
      "port": 53,
      "domains": ["regex:\\.goo.*\\.com$"],
      "expectedIPs": ["geoip:us"],
      "skipFallback": false
     },
    
      "localhost"
    ],
    "queryStrategy": "UseIP",
    "disableCache": false,
    "disableFallback": false,
    "disableFallbackIfMatch": false,
    "useSystemHosts": false
    
  },
  "fakedns": [
  {
    "ipPool": "198.18.0.0/15",
    "poolSize": 65535
  },
  {
    "ipPool": "fc00::/18",
    "poolSize": 65535
  }
],
  "stats": {}, 
  "reverse": null,
  "observatory": null,
  "burstObservatory": null,
  "policy": {
    "levels": {
      "0": {
        "handshake": 2, 
          "connIdle": 120,
            "statsUserUplink": true,
        "statsUserDownlink": true
      }
    },
    "system": {
      "statsInboundUplink": true,
      "statsInboundDownlink": true,
      "statsOutboundUplink": true,
      "statsOutboundDownlink": true
    }
  },
  "routing": {
    "domainStrategy": "IPIfNonMatch",
    "domainMatcher": "hybrid",
    "rules": [
      {
        "ruleTag": "api",
        "inboundTag": [
          "api"
        ],
        "outboundTag": "api"
      },
      {
        "ruleTag": "bt",
        "protocol": [
          "bittorrent"
        ],
        "outboundTag": "block"
      },
      {
        "domainMatcher": "hybrid",
        "type": "field",
        "ruleTag": "know-ad",
        "domain": [
          "regexp:^.*\\.doubleclick\\.net$",
          "regexp:^(?:pagead2\\.googlesyndication\\.com|s\\.youtube\\.com)$" ,
          "domain:notifications-pa.googleapis.com",
          "domain:people-pa.googleapis.com",
          "domain:redirector.googlevideo.com",
          "domain:suggestqueries.google.com",
          "domain:mip.ymclg.cn",
          "pur-oil-in-global-health-issue.colbydunlop.com"
        ],
       "outboundTag": "block"
      },
        
        {
                "domain": [
                    "geosite:netflix"
                ],
                "user": [
                    "vps@v1"
                ],
                "outboundTag": "vps_v1"
            },
            {
                "domain": [
                    "geosite:netflix"
                  ],
                    "user": [
                    "vps@v2",
                    "vps@v3"
                  ],
                "outboundTag": "vps_v2"
            },
      {
        "ruleTag": "private-ip",
        "ip": [
          "geoip:private"
        ],
        "outboundTag": "block"
      },
      {
        "ruleTag": "cn-ip",
        "ip": [
          "geoip:cn"
        ],
        "outboundTag": "block"
      },

      {
        "ruleTag": "ad-domain",
        "domain": [
          "geosite:category-ads-all"
        ],
        "outboundTag": "block"
      }
    ]
  },
  "inbounds": [
    {
      "tag": "api",
      "listen": "127.0.0.1",
      "port": 32768,
      "protocol": "dokodemo-door",
      "settings": {
        "address": "127.0.0.1"
      },
      "sniffing": null
    },

     {
      "tag": "VLESS-VISION-REALITY-MID",
      "listen": "0.0.0.0",
      "port":3443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "email": "vless@xtls.reality",
            "id": "1d65ca0b-7d07-4955-8e83-67f0f72910e5",
            "flow": "xtls-rprx-vision",
         
            "level": 0
          }
        ],
        "decryption": "none" ,
        "fallbacks": [
           
           {
            "dest": "/dev/shm/nsx/xray_reality_proxy.sock",
            "xver": 0
           }
        ]
      },
      "streamSettings": {
        "network": "raw",
        "security": "reality",
        "realitySettings": {
          "show": false,
          "target": "cloudflare.com:443",
          "xver": 0,
          "serverNames": [
            "yourdomain"    
          ],
          "privateKey": "mP2txgrkwLevCxhE4hY3V6gjmeNfyPI1zNRkP2-S1Fw",   
          "password": "w9CN51rFdzGGvBU8x7s6bj-DGYVRXIbd5l1DK6ehjiQ",
          "maxTimeDiff": 0,
          "shortIds": [
             "",
            "af660aa6",
            "1bc0a22dbe5bfbf1"
          ],
          "mldsa65Seed": "", 
          "mldsa65Verify": "",
          "limitFallbackUpload": {
                        "afterBytes": 0,
                        "bytesPerSec": 0,
                        "burstBytesPerSec": 0 
                    },
          "limitFallbackDownload": {
                        "afterBytes": 0, 
                        "bytesPerSec": 0, 
                        "burstBytesPerSec": 0 
                    }
        },
         "rawSettings": {
          "acceptProxyProtocol": false 
        }
      },
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls",
          "quic"
        ]
      }
    },
   
    {
      "tag": "VLESS-VISION-REALITY",
      "listen": "/dev/shm/nsx/xray_reality_proxy.sock,0666",
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "email": "vless@xtls.reality",
            "id": "f98968ca-3da5-4aca-a632-11b6293a63ff",
            "flow": "xtls-rprx-vision",
         
            "level": 0
          }
        ],
        "decryption": "none" ,
        "fallbacks": [
             {
             "path": "/vlesssplithttp",
             "dest": "/dev/shm/nsx/vlesssplithttp.sock",
             "xver": 0
            },
             {
             "path": "/vlesshttpupgrade",
             "dest": "/dev/shm/nsx/vlesshttpupgrade.sock",
             "xver": 0
            },
            {
             "path": "/vlessws",
             "dest": "/dev/shm/nsx/vlessws.sock",
             "xver": 0
            },
            {
          
             "path": "/vmessws",
             "dest": "/dev/shm/nsx/vmessws.sock",
             "xver": 0
            },
           {
            "dest": "/dev/shm/nsx/vless_xhttp_reality.sock",
            "xver": 0
           }
        ]
      },
      "streamSettings": {
        "network": "raw",
        "security": "reality",
        "realitySettings": {
          "show": false,
          "target": "/dev/shm/nsx/xray_tls_proxy.sock",
 
          "xver": 0,
          "serverNames": [
            "yourdomain"
            
          ],
          "privateKey": "mP2txgrkwLevCxhE4hY3V6gjmeNfyPI1zNRkP2-S1Fw",   
          "password": "w9CN51rFdzGGvBU8x7s6bj-DGYVRXIbd5l1DK6ehjiQ",
          "maxTimeDiff": 0,
          "shortIds": [
             "",
            "af660aa6",
            "1bc0a22dbe5bfbf1"
          ]
        },
         "rawSettings": {
          "acceptProxyProtocol": false 
        }
      },
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls",
          "quic"
        ]
      }
    },
    {
      "tag": "VLESS-XHTTP-REALITY",
      "listen": "/dev/shm/nsx/vless_xhttp_reality.sock,0666",
      "protocol": "vless",
      "settings": {
        "clients": [
            
          {
            "email": "vless@xhttp.reality",
            "id": "8ce89b55-3e00-4cfb-a070-25fe740acf08",
            "level": 0
          },
          {
                "id": "0d8b2c13-9cd2-40d2-bde1-3f569262d74d",             
                "email": "vps@v1",
                "level": 0
          },
          {
                "id": "71267ff0-5434-4a0e-96f4-e8fa034cfacd", 
                "email": "vps@v2",
                "level": 0
          },
          {
                "id": "1c978496-fb79-4c09-bf28-bde7f5edb130", 
                "email": "vps@v3",
                "level": 0
          }
        ],
        "decryption": "none",
          "fallbacks": [
          {
            "dest": "/dev/shm/nsx/trojan_xhttp_reality.sock",
            "xver": 0
          }
        ]
      },
      "streamSettings": {
        "network": "xhttp",
        "security": "none",
        "xhttpSettings": {
          "host": "",
          "path": "/reality/xhttp",
          "mode": "auto"
  
      }
   
    },
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls",
          "quic"
        ],
     "metadataOnly": false,
        "routeOnly": false 
       }
    },

    
  {
      "tag": "TROJAN-XHTTP-REALITY",
      "listen": "/dev/shm/nsx/trojan_xhttp_reality.sock,0666",
      "protocol": "trojan",
      "settings": {
        "clients": [
          {
            "email": "trojan@xhttp.reality",
            "password": "aWHLEL0z5tMMJv1xD5AXjQ==",
            "level": 0
          }
        ],
        "decryption": "none",
        "fallbacks": [ 
       
           {  
            "dest": "/dev/shm/nsx/xray_tls_proxy.sock",
             "xver": 0
           }
        ]
      },
     
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls",
          "quic"
        ]
      }
    },
  
    {
      "tag": "VLESS-TLS-TCP",
      "listen": "/dev/shm/nsx/xray_tls_proxy.sock,0666",
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "email": "vless@tls",
            "id": "ad78b05c-3cc8-4e50-b931-2467de3b576c",
            "flow": "xtls-rprx-vision",
            "level": 0
          }
        ],
        "decryption": "none",
        "fallbacks": [
            {
          
             "path": "/vlesssplithttp",
             "dest": "/dev/shm/nsx/vlesssplithttp.sock",
             "xver": 0
            },
             {
        
             "path": "/vlesshttpupgrade",
             "dest": "/dev/shm/nsx/vlesshttpupgrade.sock",
             "xver": 0
            },
            {
          
             "path": "/vlessws",
             "dest": "/dev/shm/nsx/vlessws.sock",
             "xver": 0
            },
            {
          
             "path": "/vmessws",
             "dest": "/dev/shm/nsx/vmessws.sock",
             "xver": 0
            },
        
          {
            "dest": "127.0.0.1:7070",
            "xver": 0
          }  
       
        ]
      },
      "streamSettings": {
        "network": "raw", 
        "security": "tls",      
        "tlsSettings": { 
          "alpn": [
            "http/1.1",
            "h2"
          ],
        
          "certificates": [
            {    
               "certificateFile": "/usr/local/nsx/certs/yourdomain.pem",
               "keyFile":         "/usr/local/nsx/certs/yourdomain.key"
            }
          ]
        },
     
        "rawSettings": {
          "acceptProxyProtocol": false
        }
      
      },
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls",
          "quic"
        ]
      }
    },
  {
    "tag":"TROJAN-TLS-TCP",

   "listen":"127.0.0.1",
    "port":7070,
	  "protocol": "trojan", 
	  "settings": {
		"clients": [
  {
    "password": "PAqpQXQ0dbD+IpVBVZROaQ==",
     "email": "trojan@TCP.TLS.Vision"
  }
],
		"fallbacks":[
		   	{	
          "dest": "/dev/shm/nsx/fallback.sock",
			    "xver":0
		  	}
		]
	  },
	  "streamSettings": {
		"network": "tcp",
		"security": "none",
    "rawSettings": {
          "acceptProxyProtocol": false
        }
	  }
	},
  {
            "tag": "Vless-splithttp",
            "listen": "/dev/shm/nsx/vlesssplithttp.sock,0666",
            "protocol": "vless",
            "settings": {
                "clients": [
                    {
                           "email": "VLESS@splithttp",
                           "id": "f4518d4e-7805-46ac-9e8d-bbe213da88a1",      
                          "level": 0                     
                    }
                ],
                "decryption": "none"
            },
            "streamSettings": {
                "network": "splithttp",
                "splithttpSettings": {
                    "path": "/vlesssplithttp"
                }
            },
            "sniffing": {
                "enabled": true,
                "destOverride": [
                    "http",
                    "tls",
                    "quic"
                ]
            }
        },
     {
           
            "tag": "Vless-ws",
            "listen": "/dev/shm/nsx/vlessws.sock,0666",
            "protocol": "vless",
            "settings": {
                "clients": [
                    {
                        "id": "44c03f7d-1e83-458e-bfa5-ef7fac40a1aa" 
                    }
                ],
                "decryption": "none"
            },
            "streamSettings": {
                "network": "ws",
                "wsSettings": {
                    "path": "/vlessws"
                }
            },
            "sniffing": {
                "enabled": true,
                "destOverride": [
                    "http",
                    "tls",
                    "quic"
                ]
            }
        },
         {
           
            "tag": "Vmess-ws",
            "listen": "/dev/shm/nsx/vmessws.sock,0666",
            "protocol": "vmess",
            "settings": {
                "clients": [
                    {
                        "id": "8f969c5f-20b8-4e38-b575-05fa22ab5446" ,
                        "level": 0,
                        "email": "ws@vmess"
                    }
                ],
                "decryption": "none"
            },
            "streamSettings": {
                "network": "ws",
                "wsSettings": {
                    "path": "/vmessws"
                }
            },
            "sniffing": {
                "enabled": true,
                "destOverride": [
                    "http",
                    "tls",
                    "quic"
                ]
            }
        },
         {
                 "tag": "Vless-httpupgrade",
            "listen": "/dev/shm/nsx/vlesshttpupgrade.sock,0666",
            "protocol": "vless",
            "settings": {
                "clients": [
                    {
                        "id": "45186f02-1662-497c-abd8-ee66eae8e402"          }
                ],
                "decryption": "none"
            },
            "streamSettings": {
                "network": "httpupgrade",
                "httpupgradeSettings": {
                    "path": "/vlesshttpupgrade"
                }
            },
            "sniffing": {
                "enabled": true,
                "destOverride": [
                    "http",
                    "tls",
                    "quic"
                ]
            }
        },
       {
      "tag": "Vless_grpc",
      "listen": "/dev/shm/nsx/nginx_grpc_vless.sock,0666",
      "protocol": "vless",
      
      "settings": {
        "clients": [
        {
          "id": "026f91f9-ba9f-44e7-b38c-d8c1314200ca",
          "email": "vless@grpc",
          "level": 0
        }
      ],
        "decryption": "none"          
      },
      "streamSettings": {
            "network": "grpc",
            "security": "none",        
            "grpcSettings": {
          
                "serviceName": "/reality/grpc/h1|h2",
                "multiMode": true
            }    
      },
      "sniffing": {
                "enabled": true,
                "destOverride": [
                    "http",
                    "tls",
                    "quic"
                ]
              }
    },

     {
      "tag": "udp-VLESS-mKCP",
      
     "listen":"0.0.0.0",
     "port":4443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "email": "vless@xtls.mkcp",
            "id": "e82d9903-c3d1-4524-a154-b8e6ba1ddf7f",
            "level": 0
          }
        ],
        "decryption": "none",
         "fallbacks": [
          {
         
           "dest": "127.0.0.1:8443" 
         
          }
        ]
      },
      "streamSettings": {
        "network": "kcp",
        "security": "tls",
        "tlsSettings": {
          "certificates": [
            {
              "certificateFile": "/usr/local/nsx/certs/yourdomain.pem",
              "keyFile": "/usr/local/nsx/certs/yourdomain.key"
            }
          ]
        },
        "kcpSettings": {
          "mtu": 1350,
          "tti": 20,
          "uplinkCapacity": 12,
          "downlinkCapacity": 100,
          "congestion": false,
          "readBufferSize": 1,
          "writeBufferSize": 1,
        
         "seed": "QvofbfMIil7768oFAyTpyA=="
        }
      },
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls",
          "quic"
        ]
      }
    },


      {
      "tag": "udp-shadowsocks",
      "protocol": "shadowsocks",
      "listen":"0.0.0.0",
      "port":8443,  
      "settings": {
        "method": "2022-blake3-aes-128-gcm",
        "level": 0,
        "password": "QvofbfMIil7768oFAyTpyA==",
        "clients": [
          {
            "password": "XddSeZtDyCkncy3bYnB6qA==",
            "email": "ss@udp"
          }
        ],
        "network": "tcp,udp"
      }
    }


   
     ],
  "outbounds": [

   
    {
      "tag": "direct",
      "domainStrategy": "UseIP",
      "protocol": "freedom"
    },
   {
    "protocol": "freedom",
      "settings": {
       "redirect": "127.0.0.1:18443" 
        
      },
      "tag": "ad-block" },
    {
      "tag": "block",
      "protocol": "blackhole"
    },

     {
            "tag": "vps_v1",
            "protocol": "shadowsocks",
            "settings": {
                "servers": [
                    {
                        "address": "107.174.131.113",
                        "port": 7081,
                        "method": "2022-blake3-aes-128-gcm",              
                         "password": "QvofbfMIil7768oFAyTpyA=="
                      
                    }
                ]
            },
            "streamSettings": {
                "sockopt": {
                    "tcpMptcp": true,
                    "tcpNoDelay": true
                }
            }
           
        },
       {
            "tag": "vps_v2",
            "protocol": "shadowsocks",
            "settings": {
                "servers": [
                    {
                        "address": "198.200.55.129",
                        "port": 7081,
                        "method": "2022-blake3-aes-128-gcm",              
                         "password": "QvofbfMIil7768oFAyTpyA=="
                      
                    }
                ]
            },
            "streamSettings": {
                "sockopt": {
                    "tcpMptcp": true,
                    "tcpNoDelay": true
                }
            }
           
        },
         {
            "tag": "vps_v3",
            "protocol": "shadowsocks",
            "settings": {
                "servers": [
                    {
                        "address": "104.219.214.2",
                        "port": 7081,
                        "method": "2022-blake3-aes-128-gcm",              
                         "password": "QvofbfMIil7768oFAyTpyA=="
                      
                    }
                ]
            },
            "streamSettings": {
                "sockopt": {
                    "tcpMptcp": true,
                    "tcpNoDelay": true
                }
            }
           
        }, 
        {
            "tag": "vps_v5",
            "protocol": "shadowsocks",
            "settings": {
                "servers": [
                    {
                        "address": "107.148.54.116",
                        "port": 7081,
                        "method": "2022-blake3-aes-128-gcm",              
                         "password": "QvofbfMIil7768oFAyTpyA=="
                      
                    }
                ]
            },
            "streamSettings": {
                "sockopt": {
                    "tcpMptcp": true,
                    "tcpNoDelay": true
                }
            }
           
        }
  ]
}
